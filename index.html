<!DOCTYPE html>

<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Processamento de Dados Financeiros</title>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    line-height: 1.6;
    color: #1f2937;
    background: #0f172a;
    position: relative;
}

/* Global background that covers entire viewport */
body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image: url('https://images.pexels.com/photos/5915230/pexels-photo-5915230.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    z-index: -2;
}

/* Global overlay that covers entire viewport */
body::after {
    content: '';
    position: fixed;
    inset: 0;
    background: linear-gradient(135deg, rgba(6, 95, 70, 0.9) 0%, rgba(20, 184, 166, 0.8) 50%, rgba(15, 23, 42, 0.9) 100%);
    z-index: -1;
}

.app-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    min-height: 100vh;
    position: relative;
    z-index: 1;
}

/* Hero Section */
.hero-section {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 3rem 2rem;
    overflow: hidden;
}

.hero-background {
    /* Remove individual background since we're using global background */
    display: none;
}

.hero-overlay {
    /* Remove individual overlay since we're using global overlay */
    display: none;
}

.hero-content {
    position: relative;
    z-index: 10;
    text-align: center;
    color: white;
    max-width: 28rem;
}

.hero-icon {
    display: flex;
    justify-content: center;
    margin-bottom: 2rem;
}

.hero-icon svg {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(8px);
    border-radius: 50%;
    padding: 1.5rem;
    color: #10b981;
}

.hero-title {
    font-size: 3rem;
    font-weight: 700;
    line-height: 1.1;
    margin-bottom: 1.5rem;
    letter-spacing: -0.025em;
}

.hero-title-accent {
    display: block;
    color: #10b981;
}

.hero-title-block {
    display: block;
}

.hero-description {
    font-size: 1.25rem;
    color: #e2e8f0;
    margin-bottom: 2rem;
    line-height: 1.6;
}

.feature-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
}

.feature-item {
    background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(8px);
    border-radius: 0.75rem;
    padding: 1rem;
    text-align: center;
    transition: all 0.3s ease;
}

.feature-item:hover {
    background: rgba(255, 255, 255, 0.1);
    transform: translateY(-2px);
}

.feature-item svg {
    color: #10b981;
    margin: 0 auto 0.5rem;
}

.feature-item p {
    font-size: 0.875rem;
    font-weight: 500;
}

/* Form Section */
.form-section {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 3rem 2rem;
    /* Remove background since we're using global background */
    position: relative;
    z-index: 10;
}

.form-container {
    width: 100%;
    max-width: 28rem;
}

.upload-form {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    border-radius: 1.5rem;
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    padding: 2rem;
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.form-header {
    text-align: center;
    margin-bottom: 2rem;
}

.form-title {
    font-size: 1.875rem;
    font-weight: 700;
    color: #111827;
    margin-bottom: 0.5rem;
}

.form-subtitle {
    color: #6b7280;
    font-size: 1rem;
}

.input-group {
    margin-bottom: 1.5rem;
}

.input-label {
    display: block;
    font-size: 0.875rem;
    font-weight: 600;
    color: #374151;
    margin-bottom: 0.5rem;
}

.input-wrapper {
    position: relative;
}

.input-icon {
    position: absolute;
    left: 0.75rem;
    top: 50%;
    transform: translateY(-50%);
    color: #9ca3af;
    pointer-events: none;
}

.form-input {
    width: 100%;
    padding: 0.75rem 0.75rem 0.75rem 2.5rem;
    border: 1px solid #d1d5db;
    border-radius: 0.75rem;
    font-size: 1rem;
    transition: all 0.2s ease;
    background: rgba(255, 255, 255, 0.9);
}

.form-input:focus {
    outline: none;
    border-color: #10b981;
    box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
    background: white;
}

.form-input.error {
    border-color: #ef4444;
}

.upload-area {
    position: relative;
    border: 2px dashed #d1d5db;
    border-radius: 0.75rem;
    padding: 2rem 1.5rem;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s ease;
    background: rgba(250, 250, 250, 0.8);
    backdrop-filter: blur(10px);
}

.upload-area:hover {
    border-color: #10b981;
    background: rgba(240, 253, 244, 0.9);
}

.upload-area.dragover {
    border-color: #10b981;
    background: rgba(240, 253, 244, 0.9);
    transform: scale(1.02);
}

.upload-area.error {
    border-color: #ef4444;
    background: rgba(254, 242, 242, 0.9);
}

.upload-icon {
    color: #10b981;
    margin: 0 auto 1rem;
}

.upload-text {
    color: #374151;
    font-weight: 500;
    margin-bottom: 0.25rem;
}

.upload-subtext {
    color: #6b7280;
    font-size: 0.875rem;
}

.file-input {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
    cursor: pointer;
}

.file-list {
    margin-bottom: 1.5rem;
}

.file-list-title {
    font-size: 0.875rem;
    font-weight: 600;
    color: #374151;
    margin-bottom: 0.75rem;
}

.file-items {
    max-height: 8rem;
    overflow-y: auto;
    border: 1px solid #e5e7eb;
    border-radius: 0.5rem;
    background: rgba(249, 250, 251, 0.9);
    backdrop-filter: blur(10px);
}

.file-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.75rem 1rem;
    border-bottom: 1px solid #e5e7eb;
    transition: background 0.2s ease;
}

.file-item:last-child {
    border-bottom: none;
}

.file-item:hover {
    background: rgba(243, 244, 246, 0.9);
}

.file-info {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    flex: 1;
    min-width: 0;
}

.file-icon {
    color: #10b981;
    flex-shrink: 0;
}

.file-name {
    color: #374151;
    font-size: 0.875rem;
    truncate: true;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.remove-button {
    background: none;
    border: none;
    color: #ef4444;
    cursor: pointer;
    padding: 0.25rem;
    border-radius: 50%;
    transition: background 0.2s ease;
    flex-shrink: 0;
}

.remove-button:hover {
    background: rgba(239, 68, 68, 0.1);
}

.submit-button {
    width: 100%;
    background: linear-gradient(135deg, #10b981 0%, #14b8a6 100%);
    color: white;
    border: none;
    padding: 1rem 1.5rem;
    border-radius: 0.75rem;
    font-size: 1.125rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
    overflow: hidden;
}

.submit-button:hover:not(:disabled) {
    background: linear-gradient(135deg, #059669 0%, #0d9488 100%);
    transform: translateY(-1px);
    box-shadow: 0 10px 25px -5px rgba(16, 185, 129, 0.4);
}

.submit-button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
}

.button-text {
    transition: opacity 0.2s ease;
}

.loading-spinner {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    position: absolute;
    inset: 0;
    background: inherit;
}

.spinner {
    width: 1.25rem;
    height: 1.25rem;
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-top: 2px solid white;
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.form-disclaimer {
    font-size: 0.75rem;
    color: #6b7280;
    text-align: center;
    margin-top: 1rem;
    line-height: 1.4;
}

.error-message {
    color: #ef4444;
    font-size: 0.875rem;
    margin-top: 0.5rem;
    padding: 0.5rem 0.75rem;
    background: rgba(254, 242, 242, 0.9);
    border-radius: 0.5rem;
    border: 1px solid #fecaca;
    display: none;
    backdrop-filter: blur(10px);
}

.error-message.show {
    display: block;
}

/* Responsive Design */
@media (max-width: 1024px) {
    .app-container {
        grid-template-columns: 1fr;
    }
    
    .hero-section {
        min-height: 50vh;
        padding: 2rem 1rem;
    }
    
    .hero-title {
        font-size: 2.5rem;
    }
    
    .hero-description {
        font-size: 1.125rem;
    }
    
    .feature-grid {
        gap: 0.75rem;
    }
    
    .form-section {
        padding: 2rem 1rem;
    }
}

@media (max-width: 768px) {
    .hero-title {
        font-size: 2rem;
    }
    
    .hero-description {
        font-size: 1rem;
    }
    
    .feature-grid {
        grid-template-columns: 1fr;
        gap: 0.5rem;
    }
    
    .upload-form {
        padding: 1.5rem;
    }
    
    .form-title {
        font-size: 1.5rem;
    }
    
    .upload-area {
        padding: 1.5rem 1rem;
    }
}

@media (max-width: 480px) {
    .hero-section,
    .form-section {
        padding: 1.5rem 1rem;
    }
    
    .upload-form {
        padding: 1.25rem;
    }
    
    .hero-icon svg {
        padding: 1rem;
        width: 48px;
        height: 48px;
    }
    
    .upload-icon {
        width: 40px;
        height: 40px;
    }
}
</style>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script></head>
<body>
<div class="app-container">
<!-- Left Side - Hero Section -->
<div class="hero-section">
<div class="hero-background"></div>
<div class="hero-overlay"></div>
<div class="hero-content">
<div class="hero-icon">
<rect height="14" rx="2" ry="2" width="20" x="2" y="3"></rect>
<line x1="8" x2="16" y1="21" y2="21"></line>
<line x1="12" x2="12" y1="17" y2="21"></line>
</svg>
</div>
<h1 class="hero-title">
                    Processamento
                    <span class="hero-title-accent">Financeiro</span>
<span class="hero-title-block">Inteligente</span>
</h1>
<p class="hero-description">
                    Envie de maneira rápida solicitações de pagamentos por email
                </p>
<div class="feature-grid">
<div class="feature-item">


</svg>
</div>
</div>
</div>
</div>
<!-- Right Side - Form -->
<div class="form-section">
<div class="form-container">
<form class="upload-form" id="uploadForm">
<div class="form-header">
<h2 class="form-title">Envie seus Dados</h2>
<p class="form-subtitle">
                            Faça upload dos arquivos e receba a planilha formatada por email
                        </p>
</div>
<!-- Email Input -->
<div class="input-group">
<label class="input-label" for="email">Email para Recebimento</label>
<div class="input-wrapper">
<svg class="input-icon" fill="none" height="20" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="20">
<path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
<polyline points="22,6 12,13 2,6"></polyline>
</svg>
<input class="form-input" id="email" name="email" placeholder="seu@email.com" required="" type="email"/>
</div>
<div class="error-message" id="emailError"></div>
</div>
<!-- File Upload -->
<div class="input-group">
<label class="input-label">Arquivos de Dados</label>
<div class="upload-area" id="uploadArea">
<svg class="upload-icon" fill="none" height="48" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="48">
<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
<polyline points="7,10 12,15 17,10"></polyline>
<line x1="12" x2="12" y1="15" y2="3"></line>
</svg>
<div class="upload-text">Clique ou arraste seus arquivos aqui</div>
<div class="upload-subtext">Formatos aceitos: CSV, XLS, XLSX</div>
<input accept=".csv,.xls,.xlsx" class="file-input" id="fileInput" multiple="" name="files[]" type="file"/>
</div>
<div class="error-message" id="fileError"></div>
</div>
<!-- File List -->
<div class="file-list" id="fileList" style="display: none;">
<h3 class="file-list-title">Arquivos Selecionados (<span id="fileCount">0</span>)</h3>
<div class="file-items" id="fileItems"></div>
</div>
  <div class="input-group">
    <label class="input-label" for="automation">Automação Financeira</label>
    <div class="input-wrapper">
        <select class="form-input" id="automation" name="automation" required>
            <option value="">Selecione uma opção</option>
            <option value="emissao_boletos">Cobrança de inadimplentes</option>
            <option value="fluxo_de_caixa">Projeção de Fluxo de Caixa</option>
            
        </select>
    </div>
    <div class="error-message" id="automationError"></div>
</div>
<!-- Submit Button -->
<button class="submit-button" disabled="" id="submitButton" type="submit">
<span class="button-text">Processar Dados</span>
<div class="loading-spinner" style="display: none;">
<div class="spinner"></div>
<span>Processando...</span>
</div>
</button>
<p class="form-disclaimer">
                        Seus dados são processados com segurança e a planilha formatada será enviada para o email informado
                    </p>
</form>
</div>
</div>
</div>
<script>
class FileUploadApp {
    constructor() {
        this.files = [];
        this.initializeElements();
        this.bindEvents();
    }

    initializeElements() {
        this.uploadArea = document.getElementById('uploadArea');
        this.fileInput = document.getElementById('fileInput');
        this.emailInput = document.getElementById('email');
        this.fileList = document.getElementById('fileList');
        this.fileItems = document.getElementById('fileItems');
        this.fileCount = document.getElementById('fileCount');
        this.submitButton = document.getElementById('submitButton');
        this.uploadForm = document.getElementById('uploadForm');
        this.emailError = document.getElementById('emailError');
        this.fileError = document.getElementById('fileError');
        this.buttonText = this.submitButton.querySelector('.button-text');
        this.loadingSpinner = this.submitButton.querySelector('.loading-spinner');
    }

    bindEvents() {
        // File upload events
        this.uploadArea.addEventListener('click', () => this.fileInput.click());
        this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));
        
        // Drag and drop events
        this.uploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));
        this.uploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));
        this.uploadArea.addEventListener('drop', (e) => this.handleDrop(e));
        
        // Form events
        this.emailInput.addEventListener('input', () => this.validateEmail());
        this.uploadForm.addEventListener('submit', (e) => this.handleSubmit(e));
    }

    isValidFileType(file) {
        const validTypes = [
            'text/csv',
            'application/vnd.ms-excel',
            'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'
        ];
        const validExtensions = ['.csv', '.xls', '.xlsx'];
        
        return validTypes.includes(file.type) || 
               validExtensions.some(ext => file.name.toLowerCase().endsWith(ext));
    }

    validateEmail() {
        const email = this.emailInput.value.trim();
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        
        if (!email) {
            this.showError('emailError', 'Email é obrigatório');
            this.emailInput.classList.add('error');
            return false;
        } else if (!emailRegex.test(email)) {
            this.showError('emailError', 'Email inválido');
            this.emailInput.classList.add('error');
            return false;
        } else {
            this.hideError('emailError');
            this.emailInput.classList.remove('error');
            return true;
        }
    }

    handleFileSelect(event) {
        this.processFiles(event.target.files);
    }

    handleDragOver(event) {
        event.preventDefault();
        event.stopPropagation();
        this.uploadArea.classList.add('dragover');
    }

    handleDragLeave(event) {
        event.preventDefault();
        event.stopPropagation();
        this.uploadArea.classList.remove('dragover');
    }

    handleDrop(event) {
        event.preventDefault();
        event.stopPropagation();
        this.uploadArea.classList.remove('dragover');
        this.processFiles(event.dataTransfer.files);
    }

    processFiles(fileList) {
        const newFiles = Array.from(fileList);
        const validFiles = [];
        const invalidFiles = [];

        newFiles.forEach(file => {
            if (this.isValidFileType(file)) {
                // Check if file already exists
                const exists = this.files.some(f => 
                    f.name === file.name && f.size === file.size
                );
                if (!exists) {
                    validFiles.push({
                        file: file,
                        id: this.generateId()
                    });
                }
            } else {
                invalidFiles.push(file.name);
            }
        });

        if (invalidFiles.length > 0) {
            this.showError('fileError', 
                `Arquivos inválidos: ${invalidFiles.join(', ')}. Use apenas CSV, XLS ou XLSX.`
            );
            this.uploadArea.classList.add('error');
        } else {
            this.hideError('fileError');
            this.uploadArea.classList.remove('error');
        }

        if (validFiles.length > 0) {
            this.files.push(...validFiles);
            this.updateFileList();
            this.updateSubmitButton();
        }
    }

    generateId() {
        return Math.random().toString(36).substr(2, 9);
    }

    updateFileList() {
        if (this.files.length === 0) {
            this.fileList.style.display = 'none';
            return;
        }

        this.fileList.style.display = 'block';
        this.fileCount.textContent = this.files.length;
        
        this.fileItems.innerHTML = '';
        
        this.files.forEach((fileItem, index) => {
            const fileElement = this.createFileElement(fileItem, index);
            this.fileItems.appendChild(fileElement);
        });
    }

    createFileElement(fileItem, index) {
        const div = document.createElement('div');
        div.className = 'file-item';
        
        div.innerHTML = `
            <div class="file-info">
                <svg class="file-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                </svg>
                <span class="file-name" title="${fileItem.file.name}">${fileItem.file.name}</span>
            </div>
            <button type="button" class="remove-button" data-index="${index}">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"/>
                    <line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
            </button>
        `;

        const removeButton = div.querySelector('.remove-button');
        removeButton.addEventListener('click', () => this.removeFile(index));

        return div;
    }

    removeFile(index) {
        this.files.splice(index, 1);
        this.updateFileList();
        this.updateSubmitButton();
        this.hideError('fileError');
        this.uploadArea.classList.remove('error');
    }

    updateSubmitButton() {
        const isEmailValid = this.validateEmail();
        const hasFiles = this.files.length > 0;
        
        this.submitButton.disabled = !(isEmailValid && hasFiles);
    }

    showError(elementId, message) {
        const errorElement = document.getElementById(elementId);
        errorElement.textContent = message;
        errorElement.classList.add('show');
    }

    hideError(elementId) {
        const errorElement = document.getElementById(elementId);
        errorElement.classList.remove('show');
    }

    async handleSubmit(event) {
        event.preventDefault();

        // Validate form
        const isEmailValid = this.validateEmail();
        const hasFiles = this.files.length > 0;

        if (!hasFiles) {
            this.showError('fileError', 'Selecione pelo menos um arquivo');
            this.uploadArea.classList.add('error');
            return;
        }

        if (!isEmailValid) {
            return;
        }

        // Show loading state
        this.setLoadingState(true);

        try {
            const formData = new FormData();
            
            // Add files to form data
            this.files.forEach(fileItem => {
                formData.append('files[]', fileItem.file);
            });
            
            // Add email to form data
            formData.append('email', this.emailInput.value.trim());

            const response = await fetch('https://n8n.maxlabinformatica.com.br/webhook/fin', {
                method: 'POST',
                body: formData,
            });

            if (response.ok) {
                // Success
                this.showSuccessMessage();
                this.resetForm();
            } else {
                throw new Error('Erro no envio');
            }
        } catch (error) {
            console.error('Upload error:', error);
            this.showError('fileError', 'Erro ao enviar arquivos. Tente novamente.');
        } finally {
            this.setLoadingState(false);
        }
    }

    setLoadingState(isLoading) {
        if (isLoading) {
            this.buttonText.style.opacity = '0';
            this.loadingSpinner.style.display = 'flex';
            this.submitButton.disabled = true;
        } else {
            this.buttonText.style.opacity = '1';
            this.loadingSpinner.style.display = 'none';
            this.updateSubmitButton();
        }
    }

    showSuccessMessage() {
        // Create and show success modal or alert
        const message = 'Arquivos enviados com sucesso! Você receberá a planilha formatada em seu email.';
        
        // Simple alert for now - could be replaced with a custom modal
        Swal.fire({
            title: 'Sucesso!',
            text: message,
            icon: 'success',
            confirmButtonText: 'OK'
        });
        
        // Alternative: Create a custom success notification
        // this.showNotification(message, 'success');
    }

    resetForm() {
        this.files = [];
        this.emailInput.value = '';
        this.fileInput.value = '';
        this.updateFileList();
        this.updateSubmitButton();
        this.hideError('emailError');
        this.hideError('fileError');
        this.emailInput.classList.remove('error');
        this.uploadArea.classList.remove('error');
    }

    // Optional: Custom notification system
    showNotification(message, type = 'info') {
        const notification = document.createElement('div');
        notification.className = `notification notification-${type}`;
        notification.textContent = message;
        
        // Style the notification
        Object.assign(notification.style, {
            position: 'fixed',
            top: '20px',
            right: '20px',
            padding: '1rem 1.5rem',
            borderRadius: '0.5rem',
            color: 'white',
            backgroundColor: type === 'success' ? '#10b981' : '#ef4444',
            boxShadow: '0 10px 25px -5px rgba(0, 0, 0, 0.1)',
            zIndex: '1000',
            transform: 'translateX(100%)',
            transition: 'transform 0.3s ease'
        });

        document.body.appendChild(notification);

        // Animate in
        setTimeout(() => {
            notification.style.transform = 'translateX(0)';
        }, 100);

        // Remove after 5 seconds
        setTimeout(() => {
            notification.style.transform = 'translateX(100%)';
            setTimeout(() => {
                document.body.removeChild(notification);
            }, 300);
        }, 5000);
    }
}

// Initialize the app when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
    new FileUploadApp();
});
</script>
</body>
</html>
